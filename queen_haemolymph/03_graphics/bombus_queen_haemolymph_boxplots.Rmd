--- 
title: "Bombus haemolymph diapause study"
output: gene_level_differential_expression_diapause.html
authors: Joe Colgan (joscolgan)
--- 

Introduction:
=============

The purpose of this script is to take label-free quantification (LFQ) values from the software program, Perseus, log transform and plot as boxplots using the R package, ggplot2. 

1. Load libraries:

```{r}
# Load libraries; install from scratch if needed
libraries <- c("ggplot2", "ggfortify", "RColorBrewer", "ggpubr", "reshape")
for (lib in libraries) {
    if (require(package = lib, character.only = TRUE)) {
        print("Successful")
    } else {
        print("Installing")
        source("https://bioconductor.org/biocLite.R")
        biocLite(pkgs = lib)
        library(lib, character.only = TRUE )
    }
}

## Create results directory:
dir.create("results")
```

1. Read in input data:

```{r}
## Read in data and store as a dataframe:
haem_data <- read.table(file = "input/diapause_results_111118_de_proteins_input_for_boxplots_immune.txt", header = FALSE)

## Assign the first column containing protein_id to the rowname:
rownames(haem_data) <- haem_data$V1

## Subset columns containing intensity values:
haem_data_subset <- haem_data[5:28]

## Transpose:
haem_data_df <- as.data.frame(t(haem_data_subset))

## Add a column indicating life-cycle 'stage':
rownames(haem_data_df)

## Create a vector of life-cycle stages:
stage <- c(rep("gyne", 4), rep("prediapause", 4), rep("early_diapause", 4),
           rep("late diapause", 4), rep("6_hrs_postdiapause", 4), rep("48_hours_postdiapause", 4))

## Add stage: 
haem_data_df$stage <- stage 

## Add levels for plotting:
haem_data_df$stage <- factor(haem_data_df$stage, levels = c(unique(as.character(unlist(haem_data_df$stage)))))
```

2. Subset proteins of interest and plot:
## ADB29128.1 - Abaecin

```{r}
## Subset 
abaecin <- haem_data_df$`ADB29128.1_abaecin,_partial_[Bombus_terrestris]`
abaecin_gyne<- abaecin[1:4]
abaecin_predia<- abaecin[5:8]
abaecin_early_diapause<- abaecin[9:12]
abaecin_late_diapause<- abaecin[13:16]
abaecin_early_postdiapause<- abaecin[17:20]
abaecin_late_postdiapause<- abaecin[21:24]

abaecin_df <- cbind(abaecin_gyne, abaecin_predia,
                 abaecin_early_diapause, abaecin_late_diapause,
                 abaecin_early_postdiapause, abaecin_late_postdiapause)

colnames(abaecin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
abaecin_df <- as.data.frame(abaecin_df)

## Reshape for plotting:
abaecin_df_melt <- melt(abaecin_df)

## Update column names:
colnames(abaecin_df_melt) <- c("Life_stage", "Log2_values")

abaecin_plot <- ggplot(abaecin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                #ylim(c(24,35)) +
                theme(legend.position="none") +
                ggtitle("Abaecin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

abaecin_plot <- abaecin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

## ADB29129.1 - Defensin:

```{r}
defensin <- haem_data_df$`ADB29129.1_defensin_1,_partial_[Bombus_terrestris]`
defensin_gyne<- defensin[1:4]
defensin_predia<- defensin[5:8]
defensin_early_diapause<- defensin[9:12]
defensin_late_diapause<- defensin[13:16]
defensin_early_postdiapause<- defensin[17:20]
defensin_late_postdiapause<- defensin[21:24]

defensin_df <- cbind(defensin_gyne, defensin_predia,
                 defensin_early_diapause, defensin_late_diapause,
                 defensin_early_postdiapause, defensin_late_postdiapause)

colnames(defensin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
defensin_df <- as.data.frame(defensin_df)

## Reshape for plotting:
defensin_df_melt <- melt(defensin_df)

## Update column names:
colnames(defensin_df_melt) <- c("Life_stage", "Log2_values")

defensin_plot <- ggplot(defensin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                 #ylim(c(24,35)) +
                theme(legend.position="none") +
                ggtitle("Defensin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

defensin_plot <- defensin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

## ADB29130.1 - Hymenoptaecin:

```{r}
## 
hymenoptaecin <- haem_data_df$`ADB29130.1_hymenoptaecin,_partial_[Bombus_terrestris]`
hymenoptaecin_gyne<- hymenoptaecin[1:4]
hymenoptaecin_predia<- hymenoptaecin[5:8]
hymenoptaecin_early_diapause<- hymenoptaecin[9:12]
hymenoptaecin_late_diapause<- hymenoptaecin[13:16]
hymenoptaecin_early_postdiapause<- hymenoptaecin[17:20]
hymenoptaecin_late_postdiapause<- hymenoptaecin[21:24]

hymenoptaecin_df <- cbind(hymenoptaecin_gyne, hymenoptaecin_predia,
                 hymenoptaecin_early_diapause, hymenoptaecin_late_diapause,
                 hymenoptaecin_early_postdiapause, hymenoptaecin_late_postdiapause)

colnames(hymenoptaecin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
hymenoptaecin_df <- as.data.frame(hymenoptaecin_df)

## Reshape for plotting:
hymenoptaecin_df_melt <- melt(hymenoptaecin_df)

## Update column names:
colnames(hymenoptaecin_df_melt) <- c("Life_stage", "Log2_values")

hymenoptaecin_plot <- ggplot(hymenoptaecin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                 #ylim(c(24,35)) +
                theme(legend.position="none") +
                ggtitle("Hymenoptaecin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

hymenoptaecin_plot <- hymenoptaecin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

## C0HKX3.1 - Apidaecin

```{r}
## 
apidaecin <- haem_data_df$`C0HKX3.1_Apidaecin_Bb_+A_[Bombus_terrestris]`
apidaecin_gyne<- apidaecin[1:4]
apidaecin_predia<- apidaecin[5:8]
apidaecin_early_diapause<- apidaecin[9:12]
apidaecin_late_diapause<- apidaecin[13:16]
apidaecin_early_postdiapause<- apidaecin[17:20]
apidaecin_late_postdiapause<- apidaecin[21:24]

apidaecin_df <- cbind(apidaecin_gyne, apidaecin_predia,
                 apidaecin_early_diapause, apidaecin_late_diapause,
                 apidaecin_early_postdiapause, apidaecin_late_postdiapause)

colnames(apidaecin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
apidaecin_df <- as.data.frame(apidaecin_df)

## Reshape for plotting:
apidaecin_df_melt <- melt(apidaecin_df)

## Update column names:
colnames(apidaecin_df_melt) <- c("Life_stage", "Log2_values")

apidaecin_plot <- ggplot(apidaecin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                 #ylim(c(24,35)) +
                theme(legend.position="none") +
                ggtitle("Apidaecin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

apidaecin_plot <- apidaecin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```
 
## Generate a combined plot:
 
```{r, message = FALSE}
ggarrange(abaecin_plot,
          defensin_plot,
          hymenoptaecin_plot,
          apidaecin_plot,
          ncol = 4, nrow=1,
          common.legend = TRUE)

ggsave(file="results/boxplot_for_amps.png",
       height = 10,
       width = 20)
```

6. XP_003394691.1 - LRRP

```{r}
## 
LRRP <- haem_data_df$`XP_003394838.1_leucine-rich_repeat-containing_protein_70_[Bombus_terrestris]`
LRRP_gyne<- LRRP[1:4]
LRRP_predia<- LRRP[5:8]
LRRP_early_diapause<- LRRP[9:12]
LRRP_late_diapause<- LRRP[13:16]
LRRP_early_postdiapause<- LRRP[17:20]
LRRP_late_postdiapause<- LRRP[21:24]

LRRP_df <- cbind(LRRP_gyne,LRRP_predia,
                 LRRP_early_diapause, LRRP_late_diapause,
                 LRRP_early_postdiapause, LRRP_late_postdiapause)

colnames(LRRP_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
LRRP_df <- as.data.frame(LRRP_df)

## Reshape for plotting:
LRRP_df_melt <- melt(LRRP_df)

## Update column names:
colnames(LRRP_df_melt) <- c("Life_stage", "Log2_values")

LRRP_plot <- ggplot(LRRP_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("LRRP70") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

LRRP_plot <- LRRP_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```


7. XP_012167632.1 - BGBP

```{r}
## 
BGBP <- haem_data_df$`XP_012167632.1_beta-1,3-glucan-binding_protein_1_[Bombus_terrestris]`
BGBP_gyne<- BGBP[1:4]
BGBP_predia<- BGBP[5:8]
BGBP_early_diapause<- BGBP[9:12]
BGBP_late_diapause<- BGBP[13:16]
BGBP_early_postdiapause<- BGBP[17:20]
BGBP_late_postdiapause<- BGBP[21:24]

BGBP_df <- cbind(BGBP_gyne, BGBP_predia,
                BGBP_early_diapause, BGBP_late_diapause,
                BGBP_early_postdiapause, BGBP_late_postdiapause)

colnames(BGBP_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
BGBP_df <- as.data.frame(BGBP_df)

## Reshape for plotting:
BGBP_df_melt <- melt(BGBP_df)

## Update column names:
colnames(BGBP_df_melt) <- c("Life_stage", "Log2_values")

BGBP_plot <- ggplot(BGBP_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("BGBP1") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

BGBP_plot <- BGBP_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

8. XP_003395541.1 - GPX

```{r}
## 
GPX <- haem_data_df$`XP_003395541.1_probable_phospholipid_hydroperoxide_glutathione_peroxidase_[Bombus_terrestris]`
GPX_gyne<- GPX[1:4]
GPX_predia<- GPX[5:8]
GPX_early_diapause<- GPX[9:12]
GPX_late_diapause<- GPX[13:16]
GPX_early_postdiapause<- GPX[17:20]
GPX_late_postdiapause<- GPX[21:24]

GPX_df <- cbind(GPX_gyne, GPX_predia,
                GPX_early_diapause, GPX_late_diapause,
                GPX_early_postdiapause, GPX_late_postdiapause)

colnames(GPX_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
GPX_df <- as.data.frame(GPX_df)

## Reshape for plotting:
GPX_df_melt <- melt(GPX_df)

## Update column names:
colnames(GPX_df_melt) <- c("Life_stage", "Log2_values")

GPX_plot <- ggplot(GPX_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Glutathione peroxidase") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

GPX_plot <- GPX_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

9. XP_003398424.1 - Serpin_B3

```{r}
## 
SOD <- haem_data_df$`XP_003397315.1_superoxide_dismutase_[Cu-Zn]_[Bombus_terrestris]`
SOD_gyne<- SOD[1:4]
SOD_predia<- SOD[5:8]
SOD_early_diapause<- SOD[9:12]
SOD_late_diapause<- SOD[13:16]
SOD_early_postdiapause<- SOD[17:20]
SOD_late_postdiapause<- SOD[21:24]

SOD_df <- cbind(SOD_gyne, SOD_predia,
                 SOD_early_diapause, SOD_late_diapause,
                 SOD_early_postdiapause, SOD_late_postdiapause)

colnames(SOD_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
SOD_df <- as.data.frame(SOD_df)

## Reshape for plotting:
SOD_df_melt <- melt(SOD_df)

## Update column names:
colnames(SOD_df_melt) <- c("Life_stage", "Log2_values")

SOD_df_plot <- ggplot(SOD_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Superoxide Dismutase") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

SOD_df_plot <- SOD_df_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

9. XP_012174896.1 - Serine protease inhibitor 3

```{r}
## Serpin 3:
Serpin_B3 <- haem_data_df$`XP_012174896.1_serine_protease_inhibitor_3-like_isoform_X2_[Bombus_terrestris]`
Serpin_B3_gyne<- Serpin_B3[1:4]
Serpin_B3_predia<- Serpin_B3[5:8]
Serpin_B3_early_diapause<- Serpin_B3[9:12]
Serpin_B3_late_diapause<- Serpin_B3[13:16]
Serpin_B3_early_postdiapause<- Serpin_B3[17:20]
Serpin_B3_late_postdiapause<- Serpin_B3[21:24]

Serpin_B3_df <- cbind(Serpin_B3_gyne, Serpin_B3_predia,
                Serpin_B3_early_diapause, Serpin_B3_late_diapause,
                 Serpin_B3_early_postdiapause, Serpin_B3_late_postdiapause)

colnames(Serpin_B3_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
Serpin_B3_df <- as.data.frame(Serpin_B3_df)

## Reshape for plotting:
Serpin_B3_df_melt <- melt(Serpin_B3_df)

## Update column names:
colnames(Serpin_B3_df_melt) <- c("Life_stage", "Log2_values")

Serpin_B3_plot <- ggplot(Serpin_B3_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Serpin_B3") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

Serpin_B3_plot <- Serpin_B3_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

10. XP_003401209.1 - Four_domain_proteases_inhibitor

```{r}
## Serpin 3:
four_domain_inhib <- haem_data_df$`XP_003401209.1_four-domain_proteases_inhibitor-like_[Bombus_terrestris]`
four_domain_inhib_gyne<- four_domain_inhib[1:4]
four_domain_inhib_predia<- four_domain_inhib[5:8]
four_domain_inhib_early_diapause<- four_domain_inhib[9:12]
four_domain_inhib_late_diapause<- four_domain_inhib[13:16]
four_domain_inhib_early_postdiapause<- four_domain_inhib[17:20]
four_domain_inhib_late_postdiapause<- four_domain_inhib[21:24]

four_domain_inhib_df <- cbind(four_domain_inhib_gyne, four_domain_inhib_predia,
                 four_domain_inhib_early_diapause, four_domain_inhib_late_diapause,
                 four_domain_inhib_early_postdiapause, four_domain_inhib_late_postdiapause)

colnames(four_domain_inhib_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
four_domain_inhib_df <- as.data.frame(four_domain_inhib_df)

## Reshape for plotting:
four_domain_inhib_df_melt <- melt(four_domain_inhib_df)

## Update column names:
colnames(four_domain_inhib_df_melt) <- c("Life_stage", "Log2_values")

four_domain_inhib_plot <- ggplot(four_domain_inhib_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Four_domain_inhibitor") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

four_domain_inhib_plot <- four_domain_inhib_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

11. XP_003401251.1 - inducible_metalloproteinase_inhibitor

```{r}
## Serpin 3:
imet_inhib <- haem_data_df$`XP_003401251.1_inducible_metalloproteinase_inhibitor_protein-like_[Bombus_terrestris]`
imet_inhib_gyne<- imet_inhib[1:4]
imet_inhib_predia<- imet_inhib[5:8]
imet_inhib_early_diapause<- imet_inhib[9:12]
imet_inhib_late_diapause<- imet_inhib[13:16]
imet_inhib_early_postdiapause<- imet_inhib[17:20]
imet_inhib_late_postdiapause<- imet_inhib[21:24]

imet_inhib_df <- cbind(imet_inhib_gyne, imet_inhib_predia,
                 imet_inhib_early_diapause, imet_inhib_late_diapause,
                 imet_inhib_early_postdiapause, imet_inhib_late_postdiapause)

colnames(imet_inhib_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
imet_inhib_df <- as.data.frame(imet_inhib_df)

## Reshape for plotting:
imet_inhib_df_melt <- melt(imet_inhib_df)

## Update column names:
colnames(imet_inhib_df_melt) <- c("Life_stage", "Log2_values")

imet_inhib_plot <- ggplot(imet_inhib_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Metalloproteinase_inhibitor") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

imet_inhib_plot <- imet_inhib_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

12. XP_003401252.1	Chymotrypsin_inhibitor

```{r}
## Chymotrypsin_inhibitor:
chym_inhib <- haem_data_df$`XP_003401252.1_chymotrypsin_inhibitor_[Bombus_terrestris]`
chym_inhib_gyne<- chym_inhib[1:4]
chym_inhib_predia<- chym_inhib[5:8]
chym_inhib_early_diapause<- chym_inhib[9:12]
chym_inhib_late_diapause<- chym_inhib[13:16]
chym_inhib_early_postdiapause<- chym_inhib[17:20]
chym_inhib_late_postdiapause<- chym_inhib[21:24]

chym_inhib_df <- cbind(chym_inhib_gyne, chym_inhib_predia,
                 chym_inhib_early_diapause, chym_inhib_late_diapause,
                 chym_inhib_early_postdiapause, chym_inhib_late_postdiapause)

colnames(chym_inhib_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
chym_inhib_df <- as.data.frame(chym_inhib_df)

## Reshape for plotting:
chym_inhib_df_melt <- melt(chym_inhib_df)

## Update column names:
colnames(chym_inhib_df_melt) <- c("Life_stage", "Log2_values")

chym_inhib_plot <- ggplot(chym_inhib_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Chymotrypsin_inhibitor_2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

chym_inhib_plot <- chym_inhib_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

4. XP_003402363.1 - protein_spaetzle

```{r}
## 
SPTZ <- haem_data_df$`XP_003402363.1_protein_spaetzle-like_[Bombus_terrestris]`
SPTZ_gyne<- SPTZ[1:4]
SPTZ_predia<- SPTZ[5:8]
SPTZ_early_diapause<- SPTZ[9:12]
SPTZ_late_diapause<- SPTZ[13:16]
SPTZ_early_postdiapause<- SPTZ[17:20]
SPTZ_late_postdiapause<- SPTZ[21:24]

SPTZ_df <- cbind(SPTZ_gyne, SPTZ_predia,
                 SPTZ_early_diapause, SPTZ_late_diapause,
                 SPTZ_early_postdiapause, SPTZ_late_postdiapause)

colnames(SPTZ_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
SPTZ_df <- as.data.frame(SPTZ_df)

## Reshape for plotting:
SPTZ_df_melt <- melt(SPTZ_df)

## Update column names:
colnames(SPTZ_df_melt) <- c("Life_stage", "Log2_values")

SPTZ_plot <- ggplot(SPTZ_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Spaetzle") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

SPTZ_plot <- SPTZ_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

2. XP_012164907.1 - thioredoxin-2

```{r}
## thioredoxin-2:
TDX <- haem_data_df$`XP_012164907.1_thioredoxin-2_[Bombus_terrestris]`
TDX_gyne<- TDX[1:4]
TDX_predia<- TDX[5:8]
TDX_early_diapause<- TDX[9:12]
TDX_late_diapause<- TDX[13:16]
TDX_early_postdiapause<- TDX[17:20]
TDX_late_postdiapause<- TDX[21:24]

TDX_df <- cbind(TDX_gyne, TDX_predia,
                 TDX_early_diapause, TDX_late_diapause,
                 TDX_early_postdiapause, TDX_late_postdiapause)

colnames(TDX_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
TDX_df <- as.data.frame(TDX_df)

## Reshape for plotting:
TDX_df_melt <- melt(TDX_df)

## Update column names:
colnames(TDX_df_melt) <- c("Life_stage", "Log2_values")

TDX_plot <- ggplot(TDX_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Thioredoxin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

TDX_plot <- TDX_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

1. XP_012166489.1 - apolipoprotein_D 

```{r}
## 
APD <- haem_data_df$`XP_012166489.1_apolipoprotein_D-like_[Bombus_terrestris]`
APD_gyne<- APD[1:4]
APD_predia<- APD[5:8]
APD_early_diapause<- APD[9:12]
APD_late_diapause<- APD[13:16]
APD_early_postdiapause<- APD[17:20]
APD_late_postdiapause<- APD[21:24]

APD_df <- cbind(APD_gyne, APD_predia,
                 APD_early_diapause, APD_late_diapause,
                 APD_early_postdiapause, APD_late_postdiapause)

colnames(APD_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
APD_df <- as.data.frame(APD_df)

## Reshape for plotting:
APD_df_melt <- melt(APD_df)

## Update column names:
colnames(APD_df_melt) <- c("Life_stage", "Log2_values")

APD_plot <- ggplot(APD_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Apolipoprotein_D") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

APD_plot <- APD_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

17. XP_012167926.1 - protein_spaetzle 

```{r}
## 
SPTZ_like <- haem_data_df$`XP_012167926.1_LOW_QUALITY_PROTEIN:_protein_spaetzle-like_[Bombus_terrestris]`
SPTZ_like_gyne<- SPTZ_like[1:4]
SPTZ_like_predia<- SPTZ_like[5:8]
SPTZ_like_early_diapause<- SPTZ_like[9:12]
SPTZ_like_late_diapause<- SPTZ_like[13:16]
SPTZ_like_early_postdiapause<- SPTZ_like[17:20]
SPTZ_like_late_postdiapause<- SPTZ_like[21:24]

SPTZ_like_df <- cbind(SPTZ_like_gyne, SPTZ_like_predia,
                 SPTZ_like_early_diapause, SPTZ_like_late_diapause,
                 SPTZ_like_early_postdiapause, SPTZ_like_late_postdiapause)

colnames(SPTZ_like_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
SPTZ_like_df <- as.data.frame(SPTZ_like_df)

## Reshape for plotting:
SPTZ_like_df_melt <- melt(SPTZ_like_df)

## Update column names:
colnames(SPTZ_like_df_melt) <- c("Life_stage", "Log2_values")

SPTZ_like_plot <- ggplot(SPTZ_like_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Spaetzle_like") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

SPTZ_like_plot <- SPTZ_like_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_012169463.2 - Alaserpin:

```{r}
## Alaserpin:
ASPN <- haem_data_df$`XP_012169463.2_LOW_QUALITY_PROTEIN:_alaserpin_[Bombus_terrestris]`
ASPN_gyne<- ASPN[1:4]
ASPN_predia<- ASPN[5:8]
ASPN_early_diapause<- ASPN[9:12]
ASPN_late_diapause<- ASPN[13:16]
ASPN_early_postdiapause<- ASPN[17:20]
ASPN_late_postdiapause<- ASPN[21:24]

ASPN_df <- cbind(ASPN_gyne, ASPN_predia,
                 ASPN_early_diapause, ASPN_late_diapause,
                 ASPN_early_postdiapause, ASPN_late_postdiapause)

colnames(ASPN_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
ASPN_df <- as.data.frame(ASPN_df)

## Reshape for plotting:
ASPN_df_melt <- melt(ASPN_df)

## Update column names:
colnames(ASPN_df_melt) <- c("Life_stage", "Log2_values")

ASPN_plot <- ggplot(ASPN_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Alaserpin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

ASPN_plot <- ASPN_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

XP_012170668.1 - Lysozyme

```{r}
## Lysozyme: 
LYSO <- haem_data_df$`XP_012170668.1_lysozyme-like_[Bombus_terrestris]`
LYSO_gyne<- LYSO[1:4]
LYSO_predia<- LYSO[5:8]
LYSO_early_diapause<- LYSO[9:12]
LYSO_late_diapause<- LYSO[13:16]
LYSO_early_postdiapause<- LYSO[17:20]
LYSO_late_postdiapause<- LYSO[21:24]

LYSO_df <- cbind(LYSO_gyne, LYSO_predia,
                 LYSO_early_diapause, LYSO_late_diapause,
                 LYSO_early_postdiapause, LYSO_late_postdiapause)

colnames(LYSO_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
LYSO_df <- as.data.frame(LYSO_df)

## Reshape for plotting:
LYSO_df_melt <- melt(LYSO_df)

## Update column names:
colnames(LYSO_df_melt) <- c("Life_stage", "Log2_values")

LYSO_plot <- ggplot(LYSO_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Lysozyme") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

LYSO_plot <- LYSO_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_012170795.1 - PGRPSC2

```{r}
## 
PGRPSC2<- haem_data_df$`XP_012170795.1_peptidoglycan-recognition_protein_SC2-like_[Bombus_terrestris]`
PGRPSC2_gyne<- PGRPSC2[1:4]
PGRPSC2_predia<- PGRPSC2[5:8]
PGRPSC2_early_diapause<- PGRPSC2[9:12]
PGRPSC2_late_diapause<- PGRPSC2[13:16]
PGRPSC2_early_postdiapause<- PGRPSC2[17:20]
PGRPSC2_late_postdiapause<- PGRPSC2[21:24]

PGRPSC2_df <- cbind(PGRPSC2_gyne, PGRPSC2_predia,
                 PGRPSC2_early_diapause, PGRPSC2_late_diapause,
                 PGRPSC2_early_postdiapause, PGRPSC2_late_postdiapause)

colnames(PGRPSC2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
PGRPSC2_df <- as.data.frame(PGRPSC2_df)

## Reshape for plotting:
PGRPSC2_df_melt <- melt(PGRPSC2_df)

## Update column names:
colnames(PGRPSC2_df_melt) <- c("Life_stage", "Log2_values")

PGRPSC2_plot <- ggplot(PGRPSC2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("PGRPSC2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

PGRPSC2_plot <- PGRPSC2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_003401252.1 - Chymotrypsin inhibitor

```{r}
## 
CI_like <- haem_data_df$`XP_003401252.1_chymotrypsin_inhibitor_[Bombus_terrestris]`
CI_like_gyne<- CI_like[1:4]
CI_like_predia<- CI_like[5:8]
CI_like_early_diapause<- CI_like[9:12]
CI_like_late_diapause<- CI_like[13:16]
CI_like_early_postdiapause<- CI_like[17:20]
CI_like_late_postdiapause<- CI_like[21:24]

CI_like_df <- cbind(CI_like_gyne, CI_like_predia,
                 CI_like_early_diapause, CI_like_late_diapause,
                 CI_like_early_postdiapause, CI_like_late_postdiapause)

colnames(CI_like_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
CI_like_df <- as.data.frame(CI_like_df)

## Reshape for plotting:
CI_like_df_melt <- melt(CI_like_df)

## Update column names:
colnames(CI_like_df_melt) <- c("Life_stage", "Log2_values")

CI_like_plot <- ggplot(CI_like_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Chymotrypsin_inhibitor_like") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

CI_like_plot <- CI_like_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_012173324.1 - PGRP2

```{r}
## PGRP2:
PGRP2 <- haem_data_df$`XP_012173324.1_peptidoglycan-recognition_protein_2-like_[Bombus_terrestris]`
PGRP2_gyne<- PGRP2[1:4]
PGRP2_predia<- PGRP2[5:8]
PGRP2_early_diapause<- PGRP2[9:12]
PGRP2_late_diapause<- PGRP2[13:16]
PGRP2_early_postdiapause<- PGRP2[17:20]
PGRP2_late_postdiapause<- PGRP2[21:24]

PGRP2_df <- cbind(PGRP2_gyne, PGRP2_predia,
                 PGRP2_early_diapause, PGRP2_late_diapause,
                 PGRP2_early_postdiapause, PGRP2_late_postdiapause)

colnames(PGRP2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
PGRP2_df <- as.data.frame(PGRP2_df)

## Reshape for plotting:
PGRP2_df_melt <- melt(PGRP2_df)

## Update column names:
colnames(PGRP2_df_melt) <- c("Life_stage", "Log2_values")

PGRP2_plot <- ggplot(PGRP2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("PGRP2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

PGRP2_plot <- PGRP2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

XP_003400229.1 - MD2

```{r}
## MD2:
MD2 <- haem_data_df$`XP_003400229.1_MD-2-related_lipid-recognition_protein-like_[Bombus_terrestris]`
MD2_gyne<- MD2[1:4]
MD2_predia<- MD2[5:8]
MD2_early_diapause<- MD2[9:12]
MD2_late_diapause<- MD2[13:16]
MD2_early_postdiapause<- MD2[17:20]
MD2_late_postdiapause<- MD2[21:24]

MD2_df <- cbind(MD2_gyne, MD2_predia,
                 MD2_early_diapause, MD2_late_diapause,
                 MD2_early_postdiapause, MD2_late_postdiapause)

colnames(MD2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
MD2_df <- as.data.frame(MD2_df)

## Reshape for plotting:
MD2_df_melt <- melt(MD2_df)

## Update column names:
colnames(MD2_df_melt) <- c("Life_stage", "Log2_values")

MD2_plot <- ggplot(MD2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("MD2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

MD2_plot <- MD2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_012175299.1 - SOT14

```{r}
## SOT14: 
SOT14 <- haem_data_df$`XP_012175299.1_suppressor_of_tumorigenicity_14_protein-like_[Bombus_terrestris]`
SOT14_gyne<- SOT14[1:4]
SOT14_predia<- SOT14[5:8]
SOT14_early_diapause<- SOT14[9:12]
SOT14_late_diapause<- SOT14[13:16]
SOT14_early_postdiapause<- SOT14[17:20]
SOT14_late_postdiapause<- SOT14[21:24]

SOT14_df <- cbind(SOT14_gyne, SOT14_predia,
                 SOT14_early_diapause, SOT14_late_diapause,
                 SOT14_early_postdiapause, SOT14_late_postdiapause)

colnames(SOT14_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
SOT14_df <- as.data.frame(SOT14_df)

## Reshape for plotting:
SOT14_df_melt <- melt(SOT14_df)

## Update column names:
colnames(SOT14_df_melt) <- c("Life_stage", "Log2_values")

SOT14_plot <- ggplot(SOT14_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("SOT14") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

SOT14_plot <- SOT14_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

XP_020718756.1 - Easter:

```{r}
## Easter: 
EASTER <- haem_data_df$`XP_020718756.1_serine_protease_easter_[Bombus_terrestris]`
EASTER_gyne<- EASTER[1:4]
EASTER_predia<- EASTER[5:8]
EASTER_early_diapause<- EASTER[9:12]
EASTER_late_diapause<- EASTER[13:16]
EASTER_early_postdiapause<- EASTER[17:20]
EASTER_late_postdiapause<- EASTER[21:24]

EASTER_df <- cbind(EASTER_gyne, EASTER_predia,
                 EASTER_early_diapause, EASTER_late_diapause,
                 EASTER_early_postdiapause, EASTER_late_postdiapause)

colnames(EASTER_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
EASTER_df <- as.data.frame(EASTER_df)

## Reshape for plotting:
EASTER_df_melt <- melt(EASTER_df)

## Update column names:
colnames(EASTER_df_melt) <- c("Life_stage", "Log2_values")

EASTER_plot <- ggplot(EASTER_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Easter") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

EASTER_plot <- EASTER_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

XP_020718755.1 - Easter_like:

```{r}
## Easter_like:
EASTER_like <- haem_data_df$`XP_020718755.1_serine_protease_easter-like_[Bombus_terrestris]`
EASTER_like_gyne<- EASTER_like[1:4]
EASTER_like_predia<- EASTER_like[5:8]
EASTER_like_early_diapause<- EASTER_like[9:12]
EASTER_like_late_diapause<- EASTER_like[13:16]
EASTER_like_early_postdiapause<- EASTER_like[17:20]
EASTER_like_late_postdiapause<- EASTER_like[21:24]

EASTER_like_df <- cbind(EASTER_like_gyne, EASTER_like_predia,
                 EASTER_like_early_diapause, EASTER_like_late_diapause,
                 EASTER_like_early_postdiapause, EASTER_like_late_postdiapause)

colnames(EASTER_like_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
EASTER_like_df <- as.data.frame(EASTER_like_df)

## Reshape for plotting:
EASTER_like_df_melt <- melt(EASTER_like_df)

## Update column names:
colnames(EASTER_like_df_melt) <- c("Life_stage", "Log2_values")

EASTER_like_plot <- ggplot(EASTER_like_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Easter_like") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

EASTER_like_plot <- EASTER_like_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

XP_020721343.1 - antichymotrypsin-2

```{r}
## antichymotrypsin-2:
ACI2 <- haem_data_df$`XP_020721343.1_antichymotrypsin-2_[Bombus_terrestris]`
ACI2_gyne<- ACI2[1:4]
ACI2_predia<- ACI2[5:8]
ACI2_early_diapause<- ACI2[9:12]
ACI2_late_diapause<- ACI2[13:16]
ACI2_early_postdiapause<- ACI2[17:20]
ACI2_late_postdiapause<- ACI2[21:24]

ACI2_df <- cbind(ACI2_gyne, ACI2_predia,
                 ACI2_early_diapause, ACI2_late_diapause,
                 ACI2_early_postdiapause, ACI2_late_postdiapause)

colnames(ACI2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
ACI2_df <- as.data.frame(ACI2_df)

## Reshape for plotting:
ACI2_df_melt <- melt(ACI2_df)

## Update column names:
colnames(ACI2_df_melt) <- c("Life_stage", "Log2_values")

ACI2_plot <- ggplot(ACI2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Antichymotrypsin_2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

ACI2_plot <- ACI2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

XP_020722610.1 - Fibrillin

```{r}
## Fibrillin:
FIB <- haem_data_df$`XP_020722610.1_fibrillin-2_[Bombus_terrestris]`
FIB_gyne<- FIB[1:4]
FIB_predia<- FIB[5:8]
FIB_early_diapause<- FIB[9:12]
FIB_late_diapause<- FIB[13:16]
FIB_early_postdiapause<- FIB[17:20]
FIB_late_postdiapause<- FIB[21:24]

FIB_df <- cbind(FIB_gyne, FIB_predia,
                 FIB_early_diapause, FIB_late_diapause,
                 FIB_early_postdiapause, FIB_late_postdiapause)

colnames(FIB_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
FIB_df <- as.data.frame(FIB_df)

## Reshape for plotting:
FIB_df_melt <- melt(FIB_df)

## Update column names:
colnames(FIB_df_melt) <- c("Life_stage", "Log2_values")

FIB_plot <- ggplot(FIB_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Fibrillin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")


FIB_plot <- FIB_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

Generate combined plots:

```{r}
## 
ggarrange( 
          PGRP2_plot, 
          PGRPSC2_plot,
          LYSO_plot,
          BGBP_plot,
          APD_plot,
          MD2_plot, 
          LRRP_plot, 
          SOT14_plot,
          EASTER_plot,
          EASTER_like_plot,
          SPTZ_like_plot, 
          SPTZ_plot,
          LYSO_plot,
          hymenoptaecin_plot,
          defensin_plot,
          abaecin_plot,
          apidaecin_plot,
          Serpin_B3_plot,
          CI_like_plot,
          chym_inhib_plot,
          ASPN_plot,
          four_domain_inhib_plot,
          ACI2_plot,
          #SOD_df_plot,
          #TDX_plot,
          #GPX_plot,
          ncol = 5, 
          nrow = 5, 
          common.legend = TRUE)

ggsave(file = "results/immune_de_proteins.jpeg",
       width = 20,
       height = 20)
```


