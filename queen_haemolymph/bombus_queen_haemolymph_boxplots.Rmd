--- 
title: "Bombus queen haemolymph proteome_boxplots"
output: bombus_queen_haemolymph_boxplots.html
--- 

Introduction:
=============

The purpose of this script is to take label-free quantification (LFQ) values from the software program, Perseus, log transform and plot as boxplots using the R package, ggplot2. 

1. Load libraries:

```{r}
# Load libraries; install from scratch if needed
libraries <- c("ggplot2", "ggfortify", "RColorBrewer", "ggpubr", "reshape")
for (lib in libraries) {
    if (require(package = lib, character.only = TRUE)) {
        print("Successful")
    } else {
        print("Installing")
        source("https://bioconductor.org/biocLite.R")
        biocLite(pkgs = lib)
        library(lib, character.only = TRUE )
    }
}

dir.create("results")

```

1. Read in input data:

```{r}
## Read in data and store as a dataframe:
haem_data <- read.table(file = "input/input_for_PCA.de_immune_genes.txt", header = FALSE)

## Assign the first column containing protein_id to the rowname:
rownames(haem_data) <- haem_data$V1

## Remove the protein ID column:
haem_data$V1 <- NULL

## Transpose:
haem_data_df <- as.data.frame(t(haem_data))

## Add a column indicating life-cycle 'stage':
rownames(haem_data_df)

## Create a vector of life-cycle stages:
stage <- c(rep("gyne", 4), rep("prediapause", 4), rep("early_diapause", 4),
           rep("late diapause", 4), rep("6_hrs_postdiapause", 4), rep("48_hours_postdiapause", 4))

## Add stage: 
haem_data_df$stage <- stage 

## Add levels for plotting:
levels(haem_data_df$stage) <- factor(haem_data_df$stage, levels = haem_data_df$stage)

## Subset for plotting:
haem_data_subset <- haem_data_df[,c(1:17)]
```

2. Subset proteins of interest and plot:
16. Abaecin

```{r}
## Subset 
abaecin <- haem_data_subset[,16]
abaecin_gyne<- abaecin[1:4]
abaecin_predia<- abaecin[5:8]
abaecin_early_diapause<- abaecin[9:12]
abaecin_late_diapause<- abaecin[13:16]
abaecin_early_postdiapause<- abaecin[17:20]
abaecin_late_postdiapause<- abaecin[21:24]

abaecin_df <- cbind(abaecin_gyne, abaecin_predia,
                 abaecin_early_diapause, abaecin_late_diapause,
                 abaecin_early_postdiapause, abaecin_late_postdiapause)

colnames(abaecin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
abaecin_df <- as.data.frame(abaecin_df)

## Reshape for plotting:
abaecin_df_melt <- melt(abaecin_df)

## Update column names:
colnames(abaecin_df_melt) <- c("Life_stage", "Log2_values")

abaecin_plot <- ggplot(abaecin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Abaecin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

abaecin_plot <- abaecin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

15. defensin:

```{r}
defensin <- haem_data_subset[,15]
defensin_gyne<- defensin[1:4]
defensin_predia<- defensin[5:8]
defensin_early_diapause<- defensin[9:12]
defensin_late_diapause<- defensin[13:16]
defensin_early_postdiapause<- defensin[17:20]
defensin_late_postdiapause<- defensin[21:24]

defensin_df <- cbind(defensin_gyne, defensin_predia,
                 defensin_early_diapause, defensin_late_diapause,
                 defensin_early_postdiapause, defensin_late_postdiapause)

colnames(defensin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
defensin_df <- as.data.frame(defensin_df)

## Reshape for plotting:
defensin_df_melt <- melt(defensin_df)

## Update column names:
colnames(defensin_df_melt) <- c("Life_stage", "Log2_values")

defensin_plot <- ggplot(defensin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Defensin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

defensin_plot <- defensin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

14. hymenoptaecin:

```{r}
## 
hymenoptaecin <- haem_data_subset[,14]
hymenoptaecin_gyne<- hymenoptaecin[1:4]
hymenoptaecin_predia<- hymenoptaecin[5:8]
hymenoptaecin_early_diapause<- hymenoptaecin[9:12]
hymenoptaecin_late_diapause<- hymenoptaecin[13:16]
hymenoptaecin_early_postdiapause<- hymenoptaecin[17:20]
hymenoptaecin_late_postdiapause<- hymenoptaecin[21:24]

hymenoptaecin_df <- cbind(hymenoptaecin_gyne, hymenoptaecin_predia,
                 hymenoptaecin_early_diapause, hymenoptaecin_late_diapause,
                 hymenoptaecin_early_postdiapause, hymenoptaecin_late_postdiapause)

colnames(hymenoptaecin_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
hymenoptaecin_df <- as.data.frame(hymenoptaecin_df)

## Reshape for plotting:
hymenoptaecin_df_melt <- melt(hymenoptaecin_df)

## Update column names:
colnames(hymenoptaecin_df_melt) <- c("Life_stage", "Log2_values")

hymenoptaecin_plot <- ggplot(hymenoptaecin_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Hymenoptaecin") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

hymenoptaecin_plot <- hymenoptaecin_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```


5. XP_003397822.1 - NPC2

```{r}
## 
NPC2 <- haem_data_subset[,5]
NPC2_gyne<- NPC2[1:4]
NPC2_predia<- NPC2[5:8]
NPC2_early_diapause<- NPC2[9:12]
NPC2_late_diapause<- NPC2[13:16]
NPC2_early_postdiapause<- NPC2[17:20]
NPC2_late_postdiapause<- NPC2[21:24]

NPC2_df <- cbind(NPC2_gyne, NPC2_predia,
                 NPC2_early_diapause, NPC2_late_diapause,
                 NPC2_early_postdiapause, NPC2_late_postdiapause)

colnames(NPC2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
NPC2_df <- as.data.frame(NPC2_df)

## Reshape for plotting:
NPC2_df_melt <- melt(NPC2_df)

## Update column names:
colnames(NPC2_df_melt) <- c("Life_stage", "Log2_values")

NPC2_plot <- ggplot(NPC2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("NPC2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

NPC2_plot <- NPC2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

6. XP_003400229.1 - MD_2_related_lipid_recognition_protein

```{r}
## 
MDL2 <- haem_data_subset[,6]
MDL2_gyne<- MDL2[1:4]
MDL2_predia<- MDL2[5:8]
MDL2_early_diapause<- MDL2[9:12]
MDL2_late_diapause<- MDL2[13:16]
MDL2_early_postdiapause<- MDL2[17:20]
MDL2_late_postdiapause<- MDL2[21:24]

MDL2_df <- cbind(MDL2_gyne, MDL2_predia,
                 MDL2_early_diapause, MDL2_late_diapause,
                 MDL2_early_postdiapause, MDL2_late_postdiapause)

colnames(MDL2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
MDL2_df <- as.data.frame(MDL2_df)

## Reshape for plotting:
MDL2_df_melt <- melt(MDL2_df)

## Update column names:
colnames(MDL2_df_melt) <- c("Life_stage", "Log2_values")

MDL2_plot <- ggplot(MDL2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("MDL2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

MDL2_plot <- MDL2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```


7. XP_012176660.1 - Leucine_rich_repeat_protein

```{r}
## 
LRRP <- haem_data_subset[,7]
LRRP_gyne<- LRRP[1:4]
LRRP_predia<- LRRP[5:8]
LRRP_early_diapause<- LRRP[9:12]
LRRP_late_diapause<- LRRP[13:16]
LRRP_early_postdiapause<- LRRP[17:20]
LRRP_late_postdiapause<- LRRP[21:24]

LRRP_df <- cbind(LRRP_gyne, LRRP_predia,
                 LRRP_early_diapause, LRRP_late_diapause,
                 LRRP_early_postdiapause, LRRP_late_postdiapause)

colnames(LRRP_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
LRRP_df <- as.data.frame(LRRP_df)

## Reshape for plotting:
LRRP_df_melt <- melt(LRRP_df)

## Update column names:
colnames(LRRP_df_melt) <- c("Life_stage", "Log2_values")

LRRP_plot <- ggplot(LRRP_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("LRRP") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

LRRP_plot <- LRRP_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

8. XP_003395667.1 - E16kDa

```{r}
## 
E16kDa <- haem_data_subset[,8]
E16kDa_gyne<- E16kDa[1:4]
E16kDa_predia<- E16kDa[5:8]
E16kDa_early_diapause<- E16kDa[9:12]
E16kDa_late_diapause<- E16kDa[13:16]
E16kDa_early_postdiapause<- E16kDa[17:20]
E16kDa_late_postdiapause<- E16kDa[21:24]

E16kDa_df <- cbind(E16kDa_gyne, E16kDa_predia,
                 E16kDa_early_diapause, E16kDa_late_diapause,
                 E16kDa_early_postdiapause, E16kDa_late_postdiapause)

colnames(E16kDa_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
E16kDa_df <- as.data.frame(E16kDa_df)

## Reshape for plotting:
E16kDa_df_melt <- melt(E16kDa_df)

## Update column names:
colnames(E16kDa_df_melt) <- c("Life_stage", "Log2_values")

E16kDa_plot <- ggplot(E16kDa_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("E16kDa") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

E16kDa_plot <- E16kDa_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

9. XP_003398424.1 - Serpin_B3

```{r}
## 
Serpin_B3 <- haem_data_subset[,8]
Serpin_B3_gyne<- Serpin_B3[1:4]
Serpin_B3_predia<- Serpin_B3[5:8]
Serpin_B3_early_diapause<- Serpin_B3[9:12]
Serpin_B3_late_diapause<- Serpin_B3[13:16]
Serpin_B3_early_postdiapause<- Serpin_B3[17:20]
Serpin_B3_late_postdiapause<- Serpin_B3[21:24]

Serpin_B3_df <- cbind(Serpin_B3_gyne, Serpin_B3_predia,
                 Serpin_B3_early_diapause, Serpin_B3_late_diapause,
                 Serpin_B3_early_postdiapause, Serpin_B3_late_postdiapause)

colnames(Serpin_B3_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
Serpin_B3_df <- as.data.frame(Serpin_B3_df)

## Reshape for plotting:
Serpin_B3_df_melt <- melt(Serpin_B3_df)

## Update column names:
colnames(Serpin_B3_df_melt) <- c("Life_stage", "Log2_values")

Serpin_B3_plot <- ggplot(Serpin_B3_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Serpin_B3") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

Serpin_B3_plot <- Serpin_B3_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

9. XP_012174896.1 - Serine protease inhibitor 3

```{r}
## Serpin 3:
Serpin_3 <- haem_data_subset[,9]
Serpin_3_gyne<- Serpin_3[1:4]
Serpin_3_predia<- Serpin_3[5:8]
Serpin_3_early_diapause<- Serpin_3[9:12]
Serpin_3_late_diapause<- Serpin_3[13:16]
Serpin_3_early_postdiapause<- Serpin_3[17:20]
Serpin_3_late_postdiapause<- Serpin_3[21:24]

Serpin_3_df <- cbind(Serpin_3_gyne, Serpin_3_predia,
                 Serpin_3_early_diapause, Serpin_3_late_diapause,
                 Serpin_3_early_postdiapause, Serpin_3_late_postdiapause)

colnames(Serpin_3_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
Serpin_3_df <- as.data.frame(Serpin_3_df)

## Reshape for plotting:
Serpin_3_df_melt <- melt(Serpin_3_df)

## Update column names:
colnames(Serpin_3_df_melt) <- c("Life_stage", "Log2_values")

Serpin_3_plot <- ggplot(Serpin_3_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Serpin_3") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

Serpin_3_plot <- Serpin_3_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

10. XP_003401209.1 - Four_domain_proteases_inhibitor

```{r}
## Serpin 3:
four_domain_inhib <- haem_data_subset[,10]
four_domain_inhib_gyne<- four_domain_inhib[1:4]
four_domain_inhib_predia<- four_domain_inhib[5:8]
four_domain_inhib_early_diapause<- four_domain_inhib[9:12]
four_domain_inhib_late_diapause<- four_domain_inhib[13:16]
four_domain_inhib_early_postdiapause<- four_domain_inhib[17:20]
four_domain_inhib_late_postdiapause<- four_domain_inhib[21:24]

four_domain_inhib_df <- cbind(four_domain_inhib_gyne, four_domain_inhib_predia,
                 four_domain_inhib_early_diapause, four_domain_inhib_late_diapause,
                 four_domain_inhib_early_postdiapause, four_domain_inhib_late_postdiapause)

colnames(four_domain_inhib_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
four_domain_inhib_df <- as.data.frame(four_domain_inhib_df)

## Reshape for plotting:
four_domain_inhib_df_melt <- melt(four_domain_inhib_df)

## Update column names:
colnames(four_domain_inhib_df_melt) <- c("Life_stage", "Log2_values")

four_domain_inhib_plot <- ggplot(four_domain_inhib_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Four_domain_inhib") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

four_domain_inhib_plot <- four_domain_inhib_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

11. AFX62369.1 - Chymotrypsin_inhibitor

```{r}
## Serpin 3:
chym_inhib_1 <- haem_data_subset[,11]
chym_inhib_1_gyne<- chym_inhib_1[1:4]
chym_inhib_1_predia<- chym_inhib_1[5:8]
chym_inhib_1_early_diapause<- chym_inhib_1[9:12]
chym_inhib_1_late_diapause<- chym_inhib_1[13:16]
chym_inhib_1_early_postdiapause<- chym_inhib_1[17:20]
chym_inhib_1_late_postdiapause<- chym_inhib_1[21:24]

chym_inhib_1_df <- cbind(chym_inhib_1_gyne, chym_inhib_1_predia,
                 chym_inhib_1_early_diapause, chym_inhib_1_late_diapause,
                 chym_inhib_1_early_postdiapause, chym_inhib_1_late_postdiapause)

colnames(chym_inhib_1_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
chym_inhib_1_df <- as.data.frame(chym_inhib_1_df)

## Reshape for plotting:
chym_inhib_1_df_melt <- melt(chym_inhib_1_df)

## Update column names:
colnames(chym_inhib_1_df_melt) <- c("Life_stage", "Log2_values")

chym_inhib_1_plot <- ggplot(chym_inhib_1_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Chym_inhib_1") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

chym_inhib_1_plot <- chym_inhib_1_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

12. XP_012172397.1	Chymotrypsin_inhibitor_2
```{r}
## Serpin 3:
chym_inhib_2 <- haem_data_subset[,12]
chym_inhib_2_gyne<- chym_inhib_2[1:4]
chym_inhib_2_predia<- chym_inhib_2[5:8]
chym_inhib_2_early_diapause<- chym_inhib_2[9:12]
chym_inhib_2_late_diapause<- chym_inhib_2[13:16]
chym_inhib_2_early_postdiapause<- chym_inhib_2[17:20]
chym_inhib_2_late_postdiapause<- chym_inhib_2[21:24]

chym_inhib_2_df <- cbind(chym_inhib_2_gyne, chym_inhib_2_predia,
                 chym_inhib_2_early_diapause, chym_inhib_2_late_diapause,
                 chym_inhib_2_early_postdiapause, chym_inhib_2_late_postdiapause)

colnames(chym_inhib_2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
chym_inhib_2_df <- as.data.frame(chym_inhib_2_df)

## Reshape for plotting:
chym_inhib_2_df_melt <- melt(chym_inhib_2_df)

## Update column names:
colnames(chym_inhib_2_df_melt) <- c("Life_stage", "Log2_values")

chym_inhib_2_plot <- ggplot(chym_inhib_2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Chym_inhib_2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

chym_inhib_2_plot <- chym_inhib_2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

4. XP_012173325.1 - peptidoglycan-recognition protein 2

```{r}
## 
PGRP2 <- haem_data_subset[,4]
PGRP2_gyne<- PGRP2[1:4]
PGRP2_predia<- PGRP2[5:8]
PGRP2_early_diapause<- PGRP2[9:12]
PGRP2_late_diapause<- PGRP2[13:16]
PGRP2_early_postdiapause<- PGRP2[17:20]
PGRP2_late_postdiapause<- PGRP2[21:24]

PGRP2_df <- cbind(PGRP2_gyne, PGRP2_predia,
                 PGRP2_early_diapause, PGRP2_late_diapause,
                 PGRP2_early_postdiapause, PGRP2_late_postdiapause)

colnames(PGRP2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
PGRP2_df <- as.data.frame(PGRP2_df)

## Reshape for plotting:
PGRP2_df_melt <- melt(PGRP2_df)

## Update column names:
colnames(PGRP2_df_melt) <- c("Life_stage", "Log2_values")

PGRP2_plot <- ggplot(PGRP2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("PGRP2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

PGRP2_plot <- PGRP2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

2. XP_012173977.1 - spaetzle

```{r}
## 
spaetzle <- haem_data_subset[,2]
spaetzle_gyne<- spaetzle[1:4]
spaetzle_predia<- spaetzle[5:8]
spaetzle_early_diapause<- spaetzle[9:12]
spaetzle_late_diapause<- spaetzle[13:16]
spaetzle_early_postdiapause<- spaetzle[17:20]
spaetzle_late_postdiapause<- spaetzle[21:24]

spaetzle_df <- cbind(spaetzle_gyne, spaetzle_predia,
                 spaetzle_early_diapause, spaetzle_late_diapause,
                 spaetzle_early_postdiapause, spaetzle_late_postdiapause)

colnames(spaetzle_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
spaetzle_df <- as.data.frame(spaetzle_df)

## Reshape for plotting:
spaetzle_df_melt <- melt(spaetzle_df)

## Update column names:
colnames(spaetzle_df_melt) <- c("Life_stage", "Log2_values")

spaetzle_plot <- ggplot(spaetzle_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Spaetzle") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

spaetzle_plot <- spaetzle_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

1. XP_012167926.1 - spaetzle_2 

```{r}
## 
spaetzle_2 <- haem_data_subset[,1]
spaetzle_2_gyne<- spaetzle_2[1:4]
spaetzle_2_predia<- spaetzle_2[5:8]
spaetzle_2_early_diapause<- spaetzle_2[9:12]
spaetzle_2_late_diapause<- spaetzle_2[13:16]
spaetzle_2_early_postdiapause<- spaetzle_2[17:20]
spaetzle_2_late_postdiapause<- spaetzle_2[21:24]

spaetzle_2_df <- cbind(spaetzle_2_gyne, spaetzle_2_predia,
                 spaetzle_2_early_diapause, spaetzle_2_late_diapause,
                 spaetzle_2_early_postdiapause, spaetzle_2_late_postdiapause)

colnames(spaetzle_2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
spaetzle_2_df <- as.data.frame(spaetzle_2_df)

## Reshape for plotting:
spaetzle_2_df_melt <- melt(spaetzle_2_df)

## Update column names:
colnames(spaetzle_2_df_melt) <- c("Life_stage", "Log2_values")

spaetzle_2_plot <- ggplot(spaetzle_2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Spaetzle_2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

spaetzle_2_plot <- spaetzle_2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

17. XP_012170668.1 - lysozyme 

```{r}
## 
lysozyme <- haem_data_subset[,17]
lysozyme_gyne<- lysozyme[1:4]
lysozyme_predia<- lysozyme[5:8]
lysozyme_early_diapause<- lysozyme[9:12]
lysozyme_late_diapause<- lysozyme[13:16]
lysozyme_early_postdiapause<- lysozyme[17:20]
lysozyme_late_postdiapause<- lysozyme[21:24]

lysozyme_df <- cbind(lysozyme_gyne, lysozyme_predia,
                 lysozyme_early_diapause, lysozyme_late_diapause,
                 lysozyme_early_postdiapause, lysozyme_late_postdiapause)

colnames(lysozyme_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
lysozyme_df <- as.data.frame(lysozyme_df)

## Reshape for plotting:
lysozyme_df_melt <- melt(lysozyme_df)

## Update column names:
colnames(lysozyme_df_melt) <- c("Life_stage", "Log2_values")

lysozyme_plot <- ggplot(lysozyme_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("Lysozyme") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")

lysozyme_plot <- lysozyme_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())

```

3. XP_012170795.1 - PGRPS2

```{r}
## 
PGRPS2 <- haem_data_subset[,3]
PGRPS2_gyne<- PGRPS2[1:4]
PGRPS2_predia<- PGRPS2[5:8]
PGRPS2_early_diapause<- PGRPS2[9:12]
PGRPS2_late_diapause<- PGRPS2[13:16]
PGRPS2_early_postdiapause<- PGRPS2[17:20]
PGRPS2_late_postdiapause<- PGRPS2[21:24]

PGRPS2_df <- cbind(PGRPS2_gyne, PGRPS2_predia,
                 PGRPS2_early_diapause, PGRPS2_late_diapause,
                 PGRPS2_early_postdiapause, PGRPS2_late_postdiapause)

colnames(PGRPS2_df) <- c("gyne", "prediapause", "early_diapause",
                       "late_diapause", "early_postdiapause", "late_postdiapause")

## Make sure it is a dataframe:
PGRPS2_df <- as.data.frame(PGRPS2_df)

## Reshape for plotting:
PGRPS2_df_melt <- melt(PGRPS2_df)

## Update column names:
colnames(PGRPS2_df_melt) <- c("Life_stage", "Log2_values")

PGRPS2_plot <- ggplot(PGRPS2_df_melt, aes(x=Life_stage, y=Log2_values, fill=Life_stage)) + 
                geom_boxplot() +
                xlab("Life stage") +
                ylab("Log2 values") +
                theme(legend.position="none") +
                ggtitle("PGRPS2") +
                scale_fill_brewer(type="qual", palette="RdBu") +
                theme_bw() +
                theme(legend.position="top")


PGRPS2_plot <- PGRPS2_plot +
                theme(axis.text=element_text(size=15),
                axis.title= element_text(size=15,face="bold"), 
                axis.text.x = element_blank())
```

4. Generate combined plots:

```{r}
## 
ggarrange(spaetzle_plot, 
          spaetzle_2_plot, 
          PGRPS2_plot, 
          PGRP2_plot, 
          NPC2_plot, 
          MDL2_plot, 
          LRRP_plot, 
          E16kDa_plot, 
          Serpin_B3_plot, 
          Serpin_3_plot,
          four_domain_inhib_plot,
          chym_inhib_1_plot,
          chym_inhib_2_plot,
          hymenoptaecin_plot,
          defensin_plot,
          abaecin_plot,
          lysozyme_plot,
          ncol = 4, 
          nrow = 5, 
          common.legend = TRUE)
```

